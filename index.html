<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Dynamo Careers Calculator</title>
    <meta name="author" content="William Hurley" />
    <meta name="description" content="Dynamo Careers salary negotiation calculator" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
  </head>
  <body>
    <img src="DynamoCareersLogo.png" alt="Dynamo Careers Logo" style="display:block;width:36%;margin:auto;" />
    <h2 style="text-align:center;">ROCK STAR SALARY NEGOTIATION CALCULATOR</h2>
    <h4 id="errorMessage"></h4>
    <form style="width:36%;margin:auto;text-align:center;">
      <label for="currentSalary">Current Salary</label><br />
      <input type="text" id="currentSalary" placeholder="$40,000" style="text-align:inherit;background-color:#FFF2CC;" required="required" tabindex="1" onkeypress="return checkInput(this, event);" onpaste="return false;" /><br /><br />
      <label for="newSalary">New Negotiated Salary</label><br />
      <input type="text" id="newSalary" placeholder="$50,000" style="text-align:inherit;background-color:#C6E0B4;" required="required" tabindex="2" onkeypress="return checkInput(this, event);" onpaste="return false;" /><br /><br />
      <label for="diffSalary">Difference</label><br />
      <input type="text" id="diffSalary" value="$10,000" style="text-align:inherit;" readonly="readonly" tabindex="-1" /><br /><br />
      <label for="costOfLiving">Annual Cost of Living (CoL) Increase</label><br />
      <input type="text" id="costOfLiving" placeholder="3.00%" style="text-align:inherit;" required="required" tabindex="3" onkeypress="return checkInput(this, event);" onpaste="return false;" /><br /><br />
      <label for="yearsTilRetire">Years remaining before retirement</label><br />
      <input type="text" id="yearsTilRetire" placeholder="31" style="text-align:inherit;" required="required" tabindex="4" onkeypress="return checkInput(this, event);" onpaste="return false;" /><br /><br />
      <h2>BY TIME OF RETIREMENT:</h2>
      <label for="currentRetired">Annual Salary at retirement (based on current salary)</label><br />
      <input type="text" id="currentRetired" value="$97,090" style="text-align:inherit;background-color:#FFF2CC;" readonly="readonly" tabindex="-1" /><br /><br />
      <label for="newRetired">Annual Salary at retirement (based on new negotiated salary)</label><br />
      <input type="text" id="newRetired" value="$121,363" style="text-align:inherit;background-color:#C6E0B4;" readonly="readonly" tabindex="-1" /><br /><br />
      <label for="diffRetired">Difference in Annual Income <span id="retireYears">31</span> Years Later</label><br />
      <input type="text" id="diffRetired" value="$24,273" style="text-align:inherit;" readonly="readonly" tabindex="-1" />
      <p style="margin:0 0 8px;"><small><strong>NOTE:</strong> Due to compound effect of CoL Increase</small></p>
      <label for="totalNewIncome">Total additional income over remaining career</label><br />
      <input type="text" id="totalNewIncome" value="$323,108" style="text-align:inherit;background-color:#C6E0B4;" readonly="readonly" tabindex="-1" /><br /><br />
      <input type="button" onclick="return runCalc();" value="See How Your New Salary Adds Up!" style="padding:10px;" tabindex="5" /><br /><br />
      <input type="text" value="Option A" style="text-align:inherit;background-color:#FFF2CC;width:81px;" readonly="readonly" tabindex="-1" />
      <input type="text" value="Option B" style="text-align:inherit;background-color:#C6E0B4;width:81px;" readonly="readonly" tabindex="-1" />
    </form>
    <script>
      function runCalc() {
        var currentSalary = document.getElementById("currentSalary"),
            newSalary = document.getElementById("newSalary"),
            diffSalary = document.getElementById("diffSalary"),
            costOfLiving = document.getElementById("costOfLiving"),
            yearsTilRetire = document.getElementById("yearsTilRetire"),
            currentRetired = document.getElementById("currentRetired"),
            newRetired = document.getElementById("newRetired"),
            diffRetired = document.getElementById("diffRetired"),
            retireYears = document.getElementById("retireYears"),
            totalNewIncome = document.getElementById("totalNewIncome"),
            cleanCurrent = Number(cleanInput(currentSalary.value)),
            cleanNew = Number(cleanInput(newSalary.value)),
            cleanCOL = Number(cleanInput(costOfLiving.value)),
            cleanYears = Number(cleanInput(yearsTilRetire.value)),
            salaryDiff = cleanNew - cleanCurrent,
            colPercent = cleanCOL / 100,
            currentSalaryFirstCOL = Number((cleanCurrent / (1 + colPercent) * colPercent).toFixed(2)),
            yearlyCurrentCOL = 0,
            yearlyNewCOL = 0,
            newIncomeAndCOL = 0,
            currentSalaryCOL = [[cleanCurrent, currentSalaryFirstCOL, currentSalaryFirstCOL]],
            newSalaryCOL = [[cleanNew, 0, salaryDiff, salaryDiff]],
            lastIndex = cleanYears - 1;

        function cleanInput(text) {
          return text.replace(/[^0-9.]/g, "");
        }

        function formatMoney(n, c, d, t) {
          var c = isNaN(c = Math.abs(c)) ? 2 : c,
              d = d == undefined ? "." : d,
              t = t == undefined ? "," : t,
              s = n < 0 ? "-" : "",
              i = String(parseInt(n = Math.abs(Number(n) || 0).toFixed(c))),
              j = (j = i.length) > 3 ? j % 3 : 0;
          return s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
        };

        for(var i = 1; i < cleanYears; i++) {
          yearlyCurrentCOL = Number((currentSalaryCOL[i - 1][0] * colPercent).toFixed(2));
          yearlyNewCOL = Number((newSalaryCOL[i - 1][0] * colPercent).toFixed(2));
          newIncomeAndCOL = yearlyNewCOL + salaryDiff;
          currentSalaryCOL[i] = [currentSalaryCOL[i - 1][0] + yearlyCurrentCOL, yearlyCurrentCOL, currentSalaryCOL[i - 1][2] + yearlyCurrentCOL];
          newSalaryCOL[i] = [newSalaryCOL[i - 1][0] + yearlyNewCOL, yearlyNewCOL, newIncomeAndCOL, newSalaryCOL[i - 1][3] + newIncomeAndCOL];
        }

        retireYears.innerHTML = cleanYears;
        currentSalary.value = "$" + formatMoney(cleanCurrent, 0);
        newSalary.value = "$" + formatMoney(cleanNew, 0);
        diffSalary.value = "$" + formatMoney(salaryDiff, 0);
        costOfLiving.value = cleanCOL.toFixed(2) + "%";
        yearsTilRetire.value = cleanYears;
        currentRetired.value = "$" + formatMoney(currentSalaryCOL[lastIndex][0], 0);
        newRetired.value = "$" + formatMoney(newSalaryCOL[lastIndex][0], 0);
        diffRetired.value = "$" + formatMoney(newSalaryCOL[lastIndex][0] - currentSalaryCOL[lastIndex][0], 0);
        totalNewIncome.value = "$" + formatMoney(newSalaryCOL[lastIndex][3] - currentSalaryCOL[lastIndex][2], 0);
      }

      function checkInput(obj, event) {
        var unicode = event.charCode ? event.charCode : event.keyCode;
        switch(true) {
          //backspace || tab
          case unicode === 8 || unicode === 9:
            return true;
            break;
          //dollar sign, up, down, left, right arrows
          case unicode >= 36 && unicode <= 40:
            return true;
            break;
          //comma || period
          case unicode === 44 || unicode === 46:
            return true;
            break;
          //numbers 0 - 9
          case unicode >= 48 && unicode <= 57:
            return true;
            break;
          default:
            return false;
        }
      }
    </script>
  </body>
</html>
